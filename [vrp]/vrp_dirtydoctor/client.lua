--[[
𝙕𝙬1𝙛𝙩𝙮𝙕𝙬1𝙛𝙩𝙮𝙕𝙬1𝙛𝙩𝙮     𝙕𝙬1𝙛𝙩𝙮        𝙕𝙬1𝙛𝙩𝙮        𝙕𝙬1𝙛𝙩𝙮      𝙕𝙬1𝙛𝙩𝙮        𝙕𝙬1𝙛𝙩𝙮𝙕𝙬1𝙛𝙩𝙮𝙕𝙬1𝙛𝙩𝙮       𝙕𝙬1𝙛𝙩𝙮𝙕𝙬1𝙛𝙩𝙮𝙕𝙬1𝙛𝙩𝙮         𝙕𝙬1𝙛𝙩𝙮        𝙕𝙬1𝙛𝙩𝙮
𝙕𝙬1𝙛𝙩𝙮𝙕𝙬1𝙛𝙩𝙮𝙕𝙬1𝙛𝙩𝙮      𝙕𝙬1𝙛𝙩𝙮       𝙕𝙬1𝙛𝙩𝙮       𝙕𝙬1𝙛𝙩𝙮       𝙕𝙬1𝙛𝙩𝙮        𝙕𝙬1𝙛𝙩𝙮𝙕𝙬1𝙛𝙩𝙮𝙕𝙬1𝙛𝙩𝙮       𝙕𝙬1𝙛𝙩𝙮𝙕𝙬1𝙛𝙩𝙮𝙕𝙬1𝙛𝙩𝙮          𝙕𝙬1𝙛𝙩𝙮      𝙕𝙬1𝙛𝙩𝙮
          𝙕𝙬1𝙛𝙩𝙮          𝙕𝙬1𝙛𝙩𝙮      𝙕𝙬1𝙛𝙩𝙮      𝙕𝙬1𝙛𝙩𝙮        𝙕𝙬1𝙛𝙩𝙮        𝙕𝙬1𝙛𝙩𝙮                          𝙕𝙬1𝙛𝙩𝙮                 𝙕𝙬1𝙛𝙩𝙮    𝙕𝙬1𝙛𝙩𝙮
        𝙕𝙬1𝙛𝙩𝙮             𝙕𝙬1𝙛𝙩𝙮     𝙕𝙬1𝙛𝙩𝙮     𝙕𝙬1𝙛𝙩𝙮         𝙕𝙬1𝙛𝙩𝙮        𝙕𝙬1𝙛𝙩𝙮𝙕𝙬1𝙛𝙩𝙮𝙕𝙬1𝙛𝙩𝙮             𝙕𝙬1𝙛𝙩𝙮                  𝙕𝙬1𝙛𝙩𝙮  𝙕𝙬1𝙛𝙩𝙮
      𝙕𝙬1𝙛𝙩𝙮                𝙕𝙬1𝙛𝙩𝙮    𝙕𝙬1𝙛𝙩𝙮    𝙕𝙬1𝙛𝙩𝙮          𝙕𝙬1𝙛𝙩𝙮        𝙕𝙬1𝙛𝙩𝙮𝙕𝙬1𝙛𝙩𝙮𝙕𝙬1𝙛𝙩𝙮             𝙕𝙬1𝙛𝙩𝙮                   𝙕𝙬1𝙛𝙩𝙮𝙕𝙬1𝙛𝙩𝙮
    𝙕𝙬1𝙛𝙩𝙮                   𝙕𝙬1𝙛𝙩𝙮   𝙕𝙬1𝙛𝙩𝙮   𝙕𝙬1𝙛𝙩𝙮           𝙕𝙬1𝙛𝙩𝙮        𝙕𝙬1𝙛𝙩𝙮                          𝙕𝙬1𝙛𝙩𝙮                      𝙕𝙬1𝙛𝙩𝙮
  𝙕𝙬1𝙛𝙩𝙮                      𝙕𝙬1𝙛𝙩𝙮  𝙕𝙬1𝙛𝙩𝙮  𝙕𝙬1𝙛𝙩𝙮            𝙕𝙬1𝙛𝙩𝙮        𝙕𝙬1𝙛𝙩𝙮                          𝙕𝙬1𝙛𝙩𝙮                      𝙕𝙬1𝙛𝙩𝙮
𝙕𝙬1𝙛𝙩𝙮𝙕𝙬1𝙛𝙩𝙮𝙕𝙬1𝙛𝙩𝙮            𝙕𝙬1𝙛𝙩𝙮 𝙕𝙬1𝙛𝙩𝙮 𝙕𝙬1𝙛𝙩𝙮             𝙕𝙬1𝙛𝙩𝙮        𝙕𝙬1𝙛𝙩𝙮                          𝙕𝙬1𝙛𝙩𝙮                      𝙕𝙬1𝙛𝙩𝙮
𝙕𝙬1𝙛𝙩𝙮𝙕𝙬1𝙛𝙩𝙮𝙕𝙬1𝙛𝙩𝙮             𝙕𝙬1𝙛𝙩𝙮𝙕𝙬1𝙛𝙩𝙮𝙕𝙬1𝙛𝙩𝙮              𝙕𝙬1𝙛𝙩𝙮        𝙕𝙬1𝙛𝙩𝙮                          𝙕𝙬1𝙛𝙩𝙮                      𝙕𝙬1𝙛𝙩𝙮
]]--

-- MADE FOR CIVILIANS NETWORK

vRP = Proxy.getInterface("vRP")

NpcSpawned = false

--TRÅD--
Citizen.CreateThread(function()
    if NpcSpawned == false then
    RequestModel(GetHashKey('s_m_m_doctor_01'))
    while not HasModelLoaded('s_m_m_doctor_01') do
        Citizen.Wait(100)
    end
    QuestGiver = CreatePed(4, 0xD47303AC, cfg.coords.x, cfg.coords.y, cfg.coords.z-0.96, cfg.coords.h, false, true)
    SetEntityHeading(QuestGiver, cfg.coords.h)
    FreezeEntityPosition(QuestGiver, true)
    SetEntityInvincible(QuestGiver, true)
    SetBlockingOfNonTemporaryEvents(QuestGiver, true)
    RequestAnimDict("amb@world_human_hang_out_street@male_c@base")
    while not HasAnimDictLoaded("amb@world_human_hang_out_street@male_c@base") do
        Citizen.Wait(100)
    end
    TaskPlayAnim(QuestGiver, "amb@world_human_hang_out_street@male_c@base", 8.0, 8.0, -1, 1, 0, 0, 0, 0)
        NpcSpawned = true
end
end)

local marker = true

Citizen.CreateThread(function()
    while true do
      Citizen.Wait(50)
      if marker == true then
        if GetDistanceBetweenCoords(GetEntityCoords(PlayerPedId()), cfg.coords.x, cfg.coords.y, cfg.coords.z, true ) < 2 then
        DrawText3Ds(cfg.coords.x, cfg.coords.y, cfg.coords.z+0.4, "Tryk ~g~E~w~ for at købe en behandling")
        if IsControlJustPressed(1, 38) then
          Citizen.Wait(10000)
          TriggerServerEvent('zwi:tjekdirty')
          end
      end
    end
  end
end)

RegisterNetEvent("givliv")
AddEventHandler("givliv", function()
    givliv()
end)

function givliv()
    local health = GetEntityHealth(PlayerPedId())
    local spiller = PlayerPedId()
    SetEntityHealth(PlayerPedId(),health+50)
    TriggerEvent("pNotify:SendNotification",{text = "Du er blevet behandlet.",type = "success",timeout = (5000),layout = "bottomCenter",queue = "global",animation = {open = "gta_effects_fade_in", close = "gta_effects_fade_out"}})
end


RegisterNetEvent("ikkepenge")
AddEventHandler("ikkepenge", function()
	TriggerEvent("pNotify:SendNotification",{text = "Du har ikke penge nok.",type = "error",timeout = (5000),layout = "centerLeft",queue = "global",animation = {open = "gta_effects_fade_in", close = "gta_effects_fade_out"}})
end)

function DrawText3Ds(x,y,z, text)
    local onScreen,_x,_y=World3dToScreen2d(x,y,z)
    local px,py,pz=table.unpack(GetGameplayCamCoords())

    SetTextScale(0.35, 0.35)
    SetTextFont(4)
    SetTextProportional(1)
    SetTextColour(255, 255, 255, 215)
    SetTextEntry("STRING")
    SetTextCentre(1)
    AddTextComponentString(text)
    DrawText(_x,_y)
    local factor = (string.len(text)) / 370
    DrawRect(_x,_y+0.0125, 0.015+ factor, 0.03, 41, 11, 41, 68)
end
